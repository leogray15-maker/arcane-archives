<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard | The Arcane Archives</title>
<link rel="icon" href="ArcaneA.png">

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: radial-gradient(circle at top, #111827, #02010a 60%, #000);
  color: #e5e5e5;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem 1.5rem 4rem;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo {
  display: flex;
  align-items: center;
  gap: .7rem;
  font-weight: 800;
  letter-spacing: .1em;
  font-size: .85rem;
}

.logo img {
  width: 32px;
}

.logout {
  cursor: pointer;
  color: #ef4444;
  font-size: .85rem;
}

.card {
  margin-top: 2rem;
  background: rgba(15,23,42,.96);
  border-radius: 20px;
  border: 1px solid rgba(148,163,184,.4);
  padding: 2rem;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(240px,1fr));
  gap: 1.5rem;
  margin-top: 2rem;
}

.tile {
  padding: 1.5rem;
  border-radius: 16px;
  border: 1px solid rgba(148,163,184,.4);
  cursor: pointer;
  transition: .2s;
}

.tile:hover {
  transform: translateY(-3px);
  border-color: #9333ea;
}

.locked {
  opacity: .45;
}

.banner {
  margin-top: 1.5rem;
  padding: 1.3rem;
  border-radius: 14px;
  background: rgba(239,68,68,.12);
  border: 1px solid rgba(239,68,68,.35);
  display: none;
}
</style>
</head>

<body>

<div class="container">

  <div class="header">
    <div class="logo">
      <img src="ArcaneA.png">
      THE ARCANE ARCHIVES
    </div>
    <div class="logout" id="logout">Log out</div>
  </div>

  <div class="card">
    <h1>Welcome, <span id="username">Member</span></h1>
    <p>Your private command center.</p>

    <div id="payBanner" class="banner">
      ðŸ”’ Upgrade required to unlock all features.
    </div>

    <div class="grid">

      <div class="tile" onclick="go('journey.html')">ðŸ§¬ Journey</div>
      <div class="tile" onclick="go('free-signals.html')">ðŸ“¡ Free Signals</div>
      <div class="tile" onclick="go('live-streams.html')">ðŸŽ¥ Public Streams</div>

      <div class="tile locked" data-paid="true" data-href="notion-invite.html">ðŸ“š Course Access</div>
      <div class="tile locked" data-paid="true" data-href="alerts.html">ðŸ“ˆ Trade Alerts</div>
      <div class="tile locked" data-paid="true" data-href="live-calls.html">ðŸŽ™ Live Calls</div>
      <div class="tile locked" data-paid="true" data-href="stock-picks.html">ðŸ’¼ Stock Picks</div>

    </div>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAK9MheMvSeOpscic4lXUsIwa0J5ubVf6w",
  authDomain: "arcane-archives-3b0f5.firebaseapp.com",
  projectId: "arcane-archives-3b0f5"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.go = (href) => location.href = href;

document.getElementById("logout").onclick = async () => {
  await signOut(auth);
  location.href = "login.html";
};

onAuthStateChanged(auth, async (user) => {
  if (!user) return location.href = "login.html";

  const snap = await getDoc(doc(db, "Users", user.uid));
  const data = snap.data() || {};
  document.getElementById("username").textContent =
    data.Username || user.email.split("@")[0];

  const paid = data.isPaid === true || data.subscriptionStatus === "active";

  if (paid) {
    document.querySelectorAll("[data-paid]").forEach(el => {
      el.classList.remove("locked");
      el.onclick = () => go(el.dataset.href);
    });
  } else {
    document.getElementById("payBanner").style.display = "block";
    document.querySelectorAll("[data-paid]").forEach(el => {
      el.onclick = () => location.href = "index.html#pricing";
    });
  }
});
</script>

</body>
</html>
