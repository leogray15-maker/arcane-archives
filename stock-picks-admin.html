<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Stock Picks | The Arcane Archives</title>
  <link rel="icon" href="ArcaneA.png" />
  <link rel="apple-touch-icon" href="ArcaneA.png">
  <link rel="manifest" href="manifest.json">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-0: #09090b;
      --bg-1: #0f0f12;
      --bg-2: #16161a;
      --bg-3: #1e1e24;
      --bg-glass: rgba(22, 22, 26, 0.7);
      --accent: #8b5cf6;
      --accent-dark: #7c3aed;
      --accent-light: #a78bfa;
      --accent-glow: rgba(139, 92, 246, 0.15);
      --accent-glow-strong: rgba(139, 92, 246, 0.35);
      --green: #22c55e;
      --green-glow: rgba(34, 197, 94, 0.15);
      --red: #ef4444;
      --red-glow: rgba(239, 68, 68, 0.15);
      --gold: #fbbf24;
      --gold-glow: rgba(251, 191, 36, 0.15);
      --text-0: #fafafa;
      --text-1: #a1a1aa;
      --text-2: #71717a;
      --border: rgba(255, 255, 255, 0.08);
      --border-hover: rgba(255, 255, 255, 0.15);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 20px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg-0);
      color: var(--text-0);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background-image:
        radial-gradient(ellipse 60% 40% at 50% 0%, var(--accent-glow) 0%, transparent 70%),
        radial-gradient(circle 1px at center, rgba(255, 255, 255, 0.035) 1px, transparent 1px);
      background-size: 100% 100%, 24px 24px;
      background-repeat: no-repeat, repeat;
      background-attachment: fixed;
    }

    /* ‚îÄ‚îÄ Back Button ‚îÄ‚îÄ */
    .back-btn {
      position: fixed;
      top: calc(1rem + env(safe-area-inset-top, 0px));
      left: 1.25rem;
      z-index: 100;
      padding: 0.5rem 1rem;
      border-radius: 50px;
      border: 1px solid var(--border);
      background: var(--bg-glass);
      color: var(--text-1);
      text-decoration: none;
      font-size: 0.8125rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      transition: all 0.2s ease;
      letter-spacing: -0.01em;
    }

    .back-btn:hover {
      color: var(--text-0);
      border-color: var(--border-hover);
      background: var(--bg-2);
      transform: translateX(-2px);
    }

    /* ‚îÄ‚îÄ Container ‚îÄ‚îÄ */
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 6rem 2rem 5rem;
    }

    /* ‚îÄ‚îÄ Page Header ‚îÄ‚îÄ */
    .page-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .page-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.375rem 1rem;
      background: var(--accent-glow);
      border: 1px solid rgba(139, 92, 246, 0.25);
      border-radius: 50px;
      font-size: 0.6875rem;
      font-weight: 700;
      color: var(--accent-light);
      margin-bottom: 1.5rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .page-header h1 {
      font-size: clamp(2rem, 5vw, 3rem);
      font-weight: 800;
      margin-bottom: 0.75rem;
      letter-spacing: -0.035em;
      background: linear-gradient(135deg, var(--text-0) 0%, var(--accent-light) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .page-header p {
      color: var(--text-1);
      font-size: 1.0625rem;
      line-height: 1.6;
      max-width: 560px;
      margin: 0 auto;
      letter-spacing: -0.01em;
    }

    /* ‚îÄ‚îÄ Disclaimer ‚îÄ‚îÄ */
    .disclaimer {
      background: var(--bg-glass);
      border: 1px solid rgba(251, 191, 36, 0.18);
      border-radius: var(--radius-md);
      padding: 1.25rem 1.5rem;
      margin-bottom: 3rem;
      font-size: 0.875rem;
      color: var(--text-1);
      line-height: 1.7;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      box-shadow: inset 0 0 0 1px rgba(251, 191, 36, 0.05), 0 0 20px var(--gold-glow);
    }

    .disclaimer strong {
      color: var(--gold);
      font-weight: 700;
    }

    /* ‚îÄ‚îÄ Categories ‚îÄ‚îÄ */
    .category {
      margin-bottom: 3rem;
    }

    .category-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.25rem;
      padding-bottom: 0.875rem;
      border-bottom: 1px solid var(--border);
    }

    .category-title {
      font-size: 1.375rem;
      font-weight: 700;
      color: var(--text-0);
      letter-spacing: -0.025em;
    }

    .category-count {
      background: var(--accent-glow);
      border: 1px solid rgba(139, 92, 246, 0.2);
      color: var(--accent-light);
      padding: 0.25rem 0.75rem;
      border-radius: 50px;
      font-size: 0.8125rem;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      min-width: 2rem;
      text-align: center;
    }

    /* ‚îÄ‚îÄ Stocks Grid ‚îÄ‚îÄ */
    .stocks-grid {
      display: grid;
      gap: 1rem;
    }

    /* ‚îÄ‚îÄ Stock Card ‚îÄ‚îÄ */
    .stock-card {
      background: var(--bg-glass);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 1.75rem;
      transition: all 0.25s ease;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .stock-card:hover {
      border-color: var(--border-hover);
      background: rgba(22, 22, 26, 0.85);
      box-shadow: 0 0 0 1px var(--border-hover), 0 8px 32px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }

    .stock-main h3 {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.625rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
      letter-spacing: -0.02em;
      color: var(--text-0);
    }

    .ticker-pill {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: white;
      padding: 0.3125rem 0.75rem;
      border-radius: var(--radius-sm);
      font-size: 0.8125rem;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 0.04em;
      box-shadow: 0 0 12px var(--accent-glow);
    }

    .stock-meta {
      color: var(--text-2);
      font-size: 0.875rem;
      margin-bottom: 1rem;
      font-weight: 500;
      letter-spacing: -0.01em;
    }

    .stock-thesis {
      color: var(--text-1);
      line-height: 1.75;
      margin-bottom: 1.125rem;
      font-size: 0.9375rem;
      letter-spacing: -0.01em;
    }

    .stock-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1.125rem;
    }

    .tag {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid var(--border);
      color: var(--text-1);
      padding: 0.3125rem 0.75rem;
      border-radius: var(--radius-sm);
      font-size: 0.8125rem;
      font-weight: 600;
      letter-spacing: -0.01em;
    }

    .tag.risk-low {
      background: var(--green-glow);
      border-color: rgba(34, 197, 94, 0.25);
      color: var(--green);
    }

    .tag.risk-medium {
      background: var(--gold-glow);
      border-color: rgba(251, 191, 36, 0.25);
      color: var(--gold);
    }

    .tag.risk-high {
      background: var(--red-glow);
      border-color: rgba(239, 68, 68, 0.25);
      color: var(--red);
    }

    /* ‚îÄ‚îÄ Level Boxes ‚îÄ‚îÄ */
    .stock-levels {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.75rem;
      margin-top: 1.125rem;
      padding-top: 1.125rem;
      border-top: 1px solid var(--border);
    }

    .level-box {
      text-align: center;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 0.875rem 0.75rem;
    }

    .level-label {
      font-size: 0.6875rem;
      color: var(--text-2);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 0.375rem;
      font-weight: 600;
    }

    .level-value {
      font-size: 1.0625rem;
      font-weight: 700;
      color: var(--accent-light);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: -0.02em;
    }

    /* ‚îÄ‚îÄ Empty State ‚îÄ‚îÄ */
    .empty-state {
      text-align: center;
      padding: 3rem 2rem;
      color: var(--text-2);
      font-size: 0.9375rem;
      background: var(--bg-glass);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    /* ‚îÄ‚îÄ Loading ‚îÄ‚îÄ */
    #loading {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--text-2);
      font-size: 1rem;
      font-weight: 500;
      letter-spacing: -0.01em;
    }

    #loading::after {
      content: '';
      display: block;
      width: 24px;
      height: 24px;
      margin: 1.25rem auto 0;
      border: 2px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
    @media (max-width: 768px) {
      .container {
        padding: 5rem 1.25rem 3rem;
      }

      .back-btn {
        top: calc(0.75rem + env(safe-area-inset-top, 0px));
        left: 1rem;
        font-size: 0.75rem;
        padding: 0.4375rem 0.875rem;
      }

      .page-header h1 {
        font-size: 1.75rem;
      }

      .page-header p {
        font-size: 0.9375rem;
      }

      .category-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.625rem;
      }

      .category-title {
        font-size: 1.1875rem;
      }

      .stock-card {
        padding: 1.375rem;
      }

      .stock-main h3 {
        font-size: 1.125rem;
      }

      .stock-levels {
        grid-template-columns: 1fr;
      }

      .disclaimer {
        padding: 1rem 1.25rem;
        font-size: 0.8125rem;
      }
    }
  </style>
</head>
<body>
  <a href="dashboard.html" class="back-btn">‚Üê Back to Dashboard</a>

  <div class="container">
    <div class="page-header">
      <span class="page-badge">üìä PREMIUM PICKS</span>
      <h1>Stock Picks</h1>
      <p>Curated equity ideas for Arcane members. Updated regularly based on market conditions.</p>
    </div>

    <div class="disclaimer">
      <strong>Disclaimer:</strong> This page is for educational purposes only and is not personal investment advice. Nothing
      here is an offer or solicitation to buy or sell any security. Markets carry risk ‚Äî including the risk of total
      loss. Always do your own research, size appropriately, and speak to a qualified professional if needed.
    </div>

    <div id="loading">Loading stock picks...</div>

    <div id="stocksContent" style="display: none;">
      <div class="category">
        <div class="category-header">
          <div class="category-title">üéØ Core Holdings</div>
          <div class="category-count" id="coreCount">0</div>
        </div>
        <div class="stocks-grid" id="coreStocks"></div>
      </div>

      <div class="category">
        <div class="category-header">
          <div class="category-title">‚ö° Tactical Positions</div>
          <div class="category-count" id="tacticalCount">0</div>
        </div>
        <div class="stocks-grid" id="tacticalStocks"></div>
      </div>

      <div class="category">
        <div class="category-header">
          <div class="category-title">üëÄ Watchlist</div>
          <div class="category-count" id="watchlistCount">0</div>
        </div>
        <div class="stocks-grid" id="watchlistStocks"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";
    import {
      getFirestore,
      collection,
      getDocs
    } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAK9MheMvSeOpscic4lXUsIwa0J5ubVf6w",
      authDomain: "arcane-archives-3b0f5.firebaseapp.com",
      projectId: "arcane-archives-3b0f5"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        window.location.href = 'login.html';
        return;
      }

      await loadStocks();
    });

    async function loadStocks() {
      try {
        const snapshot = await getDocs(collection(db, 'StockPicks'));

        const coreStocks = [];
        const tacticalStocks = [];
        const watchlistStocks = [];

        snapshot.forEach((doc) => {
          const stock = { id: doc.id, ...doc.data() };
          if (stock.category === 'core') coreStocks.push(stock);
          else if (stock.category === 'tactical') tacticalStocks.push(stock);
          else if (stock.category === 'watchlist') watchlistStocks.push(stock);
        });

        const sortByDate = (a, b) => {
          const aTime = a.createdAt?.toMillis() || 0;
          const bTime = b.createdAt?.toMillis() || 0;
          return bTime - aTime;
        };

        coreStocks.sort(sortByDate);
        tacticalStocks.sort(sortByDate);
        watchlistStocks.sort(sortByDate);

        renderStocks('coreStocks', coreStocks, 'coreCount');
        renderStocks('tacticalStocks', tacticalStocks, 'tacticalCount');
        renderStocks('watchlistStocks', watchlistStocks, 'watchlistCount');

        document.getElementById('loading').style.display = 'none';
        document.getElementById('stocksContent').style.display = 'block';
      } catch (error) {
        console.error('Error loading stocks:', error);
        document.getElementById('loading').innerHTML = `
          <div style="color: var(--red);">
            Error loading stock picks. Please try again later.<br>
            <small style="color: var(--text-dim); margin-top: 0.5rem; display: block;">
              ${error.message}
            </small>
          </div>
        `;
      }
    }

    function renderStocks(containerId, stocks, countId) {
      const container = document.getElementById(containerId);
      const countEl = document.getElementById(countId);

      countEl.textContent = stocks.length;

      if (stocks.length === 0) {
        container.innerHTML = '<div class="empty-state">No stocks in this category yet</div>';
        return;
      }

      container.innerHTML = stocks.map(stock => `
        <div class="stock-card">
          <div class="stock-main">
            <h3>
              <span class="ticker-pill">${stock.ticker}</span>
              ${stock.companyName}
            </h3>
            <div class="stock-meta">
              ${stock.sector} ‚Ä¢ ${stock.region || 'N/A'}
            </div>
            <div class="stock-thesis">
              ${stock.thesis}
            </div>
            <div class="stock-tags">
              <span class="tag risk-${stock.riskLevel}">Risk: ${capitalizeFirst(stock.riskLevel)}</span>
              ${stock.timeframe ? `<span class="tag">${stock.timeframe}</span>` : ''}
              ${stock.conviction ? `<span class="tag">Conviction: ${stock.conviction}</span>` : ''}
            </div>
          </div>

          <div class="stock-levels">
            ${stock.entryLow || stock.entryHigh ? `
              <div class="level-box">
                <div class="level-label">Entry Zone</div>
                <div class="level-value">
                  ${formatPrice(stock.entryLow)} - ${formatPrice(stock.entryHigh)}
                </div>
              </div>
            ` : ''}

            ${stock.target1 || stock.target2 ? `
              <div class="level-box">
                <div class="level-label">Targets</div>
                <div class="level-value">
                  ${formatPrice(stock.target1)}${stock.target2 ? ` / ${formatPrice(stock.target2)}` : ''}
                </div>
              </div>
            ` : ''}

            ${stock.stopLoss ? `
              <div class="level-box">
                <div class="level-label">Hard Exit</div>
                <div class="level-value">${formatPrice(stock.stopLoss)}</div>
              </div>
            ` : ''}
          </div>
        </div>
      `).join('');
    }

    function formatPrice(price) {
      if (!price) return 'N/A';
      return '$' + parseFloat(price).toFixed(2);
    }

    function capitalizeFirst(str) {
      if (!str) return '';
      return str.charAt(0).toUpperCase() + str.slice(1);
    }
  </script>
</body>
</html>
